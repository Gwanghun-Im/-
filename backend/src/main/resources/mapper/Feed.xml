<?xml version="1.0" encoding="UTF-8"?>

<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" 
	"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
	
<mapper namespace="com.web.curation.model.dao.FeedDao">

	<select id="getRecipeContents" parameterType="String" resultType="RecipeSingleContent">
		select * from recipe_content where recipe_idx = #{recipe_idx}
	</select>
	
	<select id="getLatestFeed" parameterType="String" resultType="RecipeContent">
		select idx, title, regdate, id 
		from recipe
		where id in (select following from follow where follower = #{id}) 
	</select>
	
	<select id="getAllRecipes" parameterType="String" resultType="RecipeContent">
		select * from recipe where id = #{id}
	</select>

	<!-- title, id -->
	<insert id="writeRecipeInfo" parameterType="Map">
		insert into recipe(title,id) values(#{title},#{id})
	</insert>
	
	<select id="getRecipe_idx" parameterType="Map" resultType="integer">
		select idx from recipe where id=#{id} and title = #{title} order by regdate desc limit 1
	</select>
	
	<!-- img, des, thumbnail, recipe_idx -->
	<insert id="writeRecipeContent" parameterType="RecipeContent">
		insert into recipe_content(img, des, thumbnail, recipe_idx)
		values(#{img}, #{des}, #{thumbnail}, #{recipe_idx})
	</insert>

</mapper>