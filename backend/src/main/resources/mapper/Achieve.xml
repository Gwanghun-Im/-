<?xml version="1.0" encoding="UTF-8"?>

<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" 
   "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
   
<mapper namespace="com.web.curation.model.dao.AchieveDao">

	<select id="getachievemasterlist" resultType="Achieve">
		select achieve_master_name from achieve group by achieve_master_name
	</select>
	
	<select id="getachieveslavelist" resultType="Achieve">
		select * from achieve
	</select>
	
	<select id="getMasterCount" resultType="Integer">
		SELECT count(achieve_master_name) from achieve group by achieve_master_name
	</select>
	<select id="getAchievecurrent" parameterType="String" resultType="Achievecurrent">
		select id, t.title as title, t.cnt as clear_cnt, e.cnt as achieve_cnt, round((t.cnt / e.cnt * 100)) as percent from (select id, title, count(*) as cnt from recipe  where id = #{id} group by title) t inner join (select achieve_title_name as title, count(*) as cnt from achieve group by achieve_title_name) e on t.title = e.title;
	</select>
	<select id="getMasterCategoryCount" parameterType="String" resultType="Achieve">
		select * from achieve where achieve_master_name = #{master}
	</select>
	<select id="getCategoryRecipe" parameterType="map" resultType="RecipeContent">
   		select * from recipe where id = #{id} and achieve_master = #{master}
    </select>
	
	
</mapper>